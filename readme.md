# INTRO. MYSQL WORKSHOP 2022

We're going to be using a large public dataset to familiarize ourselves with MySQL Workbench. This repository is mostly a supplement to our discussion.

For the workshop, you'll want to:

	* download the Desktop client: https://www.mysql.com/products/workbench/
	* install the Rice VPN client to connect to the example db
	
What follows lays out how I built the database we're going to use. We'll visit this repository at the end of the lesson to show you how to go further with it if you're interested.

## first, some resources

* Dataset 
	* HCAD IMPORT INSTRUCTIONS: https://hcad.org/assets/uploads/pdf/Import_Instructions.pdf
	* CODEBOOK for importation: https://hcad.org/assets/uploads/pdf/pdataCodebook.pdf
	* DOWNLOADABLE DATASESTS: https://hcad.org/pdata/pdata-property-downloads.html
* In this repository
	* MySQL server setup recipe (it's dated but for transparency this is how I built this one)
	* a translation of some tables from the HCAD codebook pdf into a tab-separated file
	* a python script for generating the appropriate CREATE TABLE statements

## create & use database commands

	create database HCAD_REAL_2022;
	use HCAD_REAL_2022;

## create table commands

these were generated by our python script, using our tab-separated transcription of the HCAD codebook

we're only using a selection of the tables in the 2022 zip files:

https://download.hcad.org/data/CAMA/2022/Real_acct_owner.zip

https://download.hcad.org/data/CAMA/2022/Real_building_land.zip


	CREATE TABLE deeds (
	`acct` varchar(13) NOT NULL COMMENT 'Account Number',
	`dos` varchar(10) COMMENT 'Date of Sale Format MM/DD/YYYY',
	`clerk_yr` varchar(10) COMMENT 'Clerk Year',
	`clerk_id` varchar(20) COMMENT 'Clerk ID Number',
	`deed_id` varchar(10) NOT NULL COMMENT 'Deed Id'
	); 


	 CREATE TABLE owners (
	`acct` varchar(13) NOT NULL COMMENT 'Account Number',
	`ln_num` varchar(10) NOT NULL COMMENT 'Owner Name',
	`name` varchar(100) COMMENT 'Owner Line Number',
	`aka` varchar(50) COMMENT 'Owner AKA',
	`pct_own` varchar(6) COMMENT 'Percent Ownership'
	); 


	 CREATE TABLE parcel_tieback (
	`acct` char(25) NOT NULL COMMENT 'Account Number',
	`tp` char(2) COMMENT 'Relationship Types See Code Descriptions(Real) - Relationship Type Or desc_r_17_relationship_type.txt',
	`dscr` varchar(100) COMMENT 'Relationship Category Description',
	`related_acct` char(25) COMMENT 'Related Account Number',
	`pct` varchar(9) COMMENT 'Percent Allocated'
	); 


	 CREATE TABLE permits (
	`acct` varchar(13) NOT NULL COMMENT 'Account Number',
	`id` varchar(10) NOT NULL COMMENT 'Permit ID',
	`agency_id` char(4) COMMENT 'Permit Agency ID',
	`status` varchar(1) COMMENT 'Permit Status See Code Descriptions(Real) - Permit Status Or desc_r_18_permit_status.txt',
	`dscr` varchar(50) COMMENT 'Permit Description',
	`dor_cd` varchar(16) COMMENT 'Property Use Code See Code Descriptions(Real) - State Class Or desc_r_01_state_class.txt',
	`permit_type` varchar(10) COMMENT 'Permit Type See Code Descriptions(Real) - Permit Code Or desc_r_19_permit_code.txt',
	`permit_tp_descr` varchar(50) COMMENT 'Permit Type Description',
	`property_tp` varchar(3) COMMENT 'Permit Property Type',
	`issue_date` varchar(10) COMMENT 'Permit Issue Date Format MM/DD/YYYY',
	`yr` varchar(4) COMMENT 'Permit Year',
	`site_num` varchar(9) COMMENT 'Permit Street Number',
	`site_pfx` varchar(2) COMMENT 'Permit Street Prefix',
	`site_str` varchar(50) COMMENT 'Permit Street Name',
	`site_tp` varchar(4) COMMENT 'Permit Street Type',
	`site_sfx` varchar(25) COMMENT 'Permit Street Suffix',
	`site_apt` varchar(6) COMMENT 'Permit Apartment Number'
	); 


	 CREATE TABLE real_acct (
	`acct` varchar(25) NOT NULL COMMENT 'Account Number',
	`yr` varchar(4) COMMENT 'Tax Year',
	`mailto` varchar(100) COMMENT 'Web Name plus Mailto',
	`mail_addr_1` varchar(50) COMMENT 'Mailing Address Line 1',
	`mail_addr_2` varchar(50) COMMENT 'Mailing Address Line 2',
	`mail_city` varchar(50) COMMENT 'Mailing City',
	`mail_state` char(2) COMMENT 'Mailing State',
	`mail_zip` varchar(10) COMMENT 'Mailing Zip code',
	`mail_country` varchar(50) COMMENT 'Mailing Country',
	`undeliverable` varchar(1) COMMENT 'Mailing Undeliverable Flag',
	`str_pfx` char(2) COMMENT 'Street Prefix',
	`str_num` varchar(10) COMMENT 'Street Number',
	`str_num_sfx` char(3) COMMENT 'Street Number Suffix',
	`str` varchar(50) COMMENT 'Street Name',
	`str_sfx` varchar(25) COMMENT 'Street Suffix',
	`str_sfx_dir` char(2) COMMENT 'Street Suffix Direction',
	`str_unit` varchar(15) COMMENT 'Street Unit',
	`site_addr_1` varchar(50) COMMENT 'Location Address information',
	`site_addr_2` varchar(50) COMMENT 'City',
	`site_addr_3` varchar(10) COMMENT 'Zip',
	`state_class` varchar(16) COMMENT 'Property Use Code See Code Descriptions(Real) - State Class Or desc_r_01_state_class.txt',
	`school_dist` varchar(5) COMMENT 'ISD Code See Code Descriptions(Real) - School District Or desc_r_20_school_district.txt',
	`map_facet` varchar(6) COMMENT 'Location Street Map',
	`key_map` varchar(6) COMMENT 'Location Map ID',
	`Neighborhood_Code` varchar(12) COMMENT 'Neighborhood Code See real_neighborhood_code.txt: cd',
	`Neighborhood_Grp` varchar(8) COMMENT 'Neighborhoods Group Code See real_neighborhood_code.txt: grp_cd See Code Descriptions(Real): HISD section',
	`Market_Area_1` varchar(8) COMMENT 'Market Area 1 See Code Descriptions(Real) - Market Area Or desc_r_21_market_area.txt',
	`Market_Area_1_Dscr` varchar(50) COMMENT 'Market Areas 1 Description',
	`Market_Area_2` varchar(8) COMMENT 'Market Area 2 See Code Descriptions(Real) - Market Area Or desc_r_21_market_area.txt',
	`Market_Area_2_Dscr` varchar(50) COMMENT 'Market Areas 2 Description',
	`econ_area` varchar(5) COMMENT 'Economic Area',
	`econ_bld_class` char(5) COMMENT 'Economic Building Class',
	`center_code` varchar(5) COMMENT 'Account Center Code',
	`yr_impr` varchar(4) COMMENT 'Parcel Year Improved',
	`yr_annexed` varchar(4) COMMENT 'Parcel Year Annexed',
	`splt_dt` char(20) COMMENT 'blank',
	`dsc_cd` char(2) COMMENT 'Parcel DSC Code',
	`nxt_bld` varchar(10) COMMENT 'Next Building',
	`bld_ar` varchar(20) COMMENT 'Total Building Area',
	`land_ar` varchar(20) COMMENT 'Total Land Area Square Footage',
	`acreage` varchar(14) COMMENT 'Total Land Area Acreage',
	`Cap_acct` varchar(7) COMMENT 'Capped Flag',
	`shared_cad` char(3) COMMENT 'Shared CAD Flag',
	`land_val` varchar(20) COMMENT 'Market Land Value',
	`bld_val` varchar(20) COMMENT 'Building Value',
	`x_features_val` varchar(20) COMMENT 'Extra Feature Value',
	`ag_val` varchar(20) COMMENT 'Classified Land Value',
	`assessed_val` varchar(20) COMMENT 'Assessed Value',
	`tot_appr_val` varchar(20) COMMENT 'Appraised Value',
	`tot_mkt_val` varchar(20) COMMENT 'Market Value',
	`prior_land_val` varchar(20) COMMENT 'Prior Year Market Land Value',
	`prior_bld_val` varchar(20) COMMENT 'Prior Year Building Value',
	`prior_x_features_val` varchar(20) COMMENT 'Prior Year Extra Feature Value',
	`prior_ag_val` varchar(20) COMMENT 'Prior Year Classified Land Value',
	`prior_tot_appr_val` varchar(20) COMMENT 'Prior Year Capped Value',
	`prior_tot_mkt_val` varchar(20) COMMENT 'Prior Year Just Value',
	`new_construction_val` varchar(20) COMMENT 'Total New Construction Value',
	`tot_rcn_val` varchar(20) COMMENT 'Total Building Replace Cost Value',
	`value_status` varchar(36) COMMENT 'Value Notice Status',
	`noticed` varchar(1) COMMENT 'Account Noticed Flag; Y/N',
	`notice_dt` varchar(10) COMMENT 'Account Noticed Date',
	`protested` varchar(1) COMMENT 'Protested Flag',
	`certified_date` varchar(10) COMMENT 'Account Certified Date',
	`rev_dt` varchar(10) COMMENT 'Date Reviewed',
	`rev_by` char(5) COMMENT 'Reviewed By',
	`new_own_dt` varchar(10) COMMENT 'New Owner Date',
	`lgl_1` varchar(50) COMMENT 'Legal Line 1 Description',
	`lgl_2` varchar(50) COMMENT 'Legal Line 2 Description',
	`lgl_3` varchar(50) COMMENT 'Legal Line 3 Description',
	`lgl_4` varchar(50) COMMENT 'Legal Line 4 Description',
	`jurs` varchar(100) COMMENT 'Account Jurisdictions'
	); 


	 CREATE TABLE real_neighborhood_code (
	`cd` varchar(11) NOT NULL COMMENT 'Neighborhood Code',
	`grp_cd` varchar(8) COMMENT 'Neighborhoods Group Code',
	`dscr` varchar(50) COMMENT 'Neighborhood Description'
	); 


	 CREATE TABLE building_other (
	`acct` varchar(25) NOT NULL COMMENT 'Account Number',
	`property_use_cd` varchar(16) COMMENT 'Property Use Code See Code Descriptions(Real) - State Class: Code Or desc_r_01_state_class.txt',
	`bld_num` varchar(10) NOT NULL COMMENT 'Building Number',
	`impr_tp` char(4) COMMENT 'Building Type See Code Descriptions(Real) - Building Type Code Or desc_r_02_building_type_code.txt',
	`impr_mdl_cd` char(4) COMMENT 'Building Style See Code Descriptions(Real) - Building Style Or desc_r_03_building_style.txt',
	`structure` char(3) COMMENT 'Building Class See Code Descriptions(Real) - Building Class Or desc_r_04_building_class.txt',
	`structure_dscr` varchar(50) COMMENT 'Class of improvement - Description',
	`noticed_Depr_Val` varchar(12) COMMENT 'Noticed Depreciated Value',
	`Depr_Val` varchar(12) COMMENT 'Depreciated Value',
	`MS_replacement_cost` varchar(12) COMMENT 'Alternate Replacement Cost',
	`cama_replacement_cost` varchar(12) COMMENT 'Replacement Cost',
	`accrued_depr_pct` varchar(9) COMMENT 'Accrued Replacement Cost',
	`qa_cd` char(2) COMMENT 'Quality Code See Code Descriptions(Real) - Quality Code Or desc_r_07_quality_code.txt',
	`dscr` varchar(50) NOT NULL COMMENT 'Building Quality Codes - Description',
	`date_erected` varchar(4) COMMENT 'Actual Year Built',
	`eff` varchar(4) COMMENT 'Effective Year Built',
	`yr_remodel` varchar(4) NOT NULL COMMENT 'Year Remodeled',
	`yr_roll` char(4) NOT NULL COMMENT 'Year On Roll',
	`appr_by` char(5) NOT NULL COMMENT 'Building Appraisal By',
	`appr_dt` varchar(10) COMMENT 'Date Appraised Format MM/DD/YYYY',
	`notes` varchar(150) COMMENT 'Note',
	`im_sq_ft` varchar(10) NOT NULL COMMENT 'Base Area',
	`act_ar` varchar(10) NOT NULL COMMENT 'Actual Area',
	`heat_ar` varchar(10) NOT NULL COMMENT 'Heated Area',
	`gross_ar` varchar(10) NOT NULL COMMENT 'Gross Area',
	`eff_ar` varchar(10) NOT NULL COMMENT 'Effective Area',
	`base_ar` varchar(10) NOT NULL COMMENT 'Base Area',
	`perimeter` varchar(10) NOT NULL COMMENT 'Perimeter',
	`pct` varchar(5) NOT NULL COMMENT 'Percent Complete',
	`category` char(2) NOT NULL COMMENT 'Income - PGI Category See Code Descriptions(Real) – PGI Category Or desc_r_08_pgi_category.txt',
	`pgi_dscr` varchar(50) NOT NULL COMMENT 'Potential Gross Income Categories - Description',
	`prop_nm` varchar(50) NOT NULL COMMENT 'PGI Income Survey - Property Name',
	`units` varchar(15) NOT NULL COMMENT 'Locations - Street Unit',
	`nra` varchar(20) COMMENT 'Net Rentable Area (sqft)',
	`lease_rt` varchar(10) NOT NULL COMMENT 'PGI Income Survey - Lease Rate',
	`occ_rt` varchar(10) NOT NULL COMMENT 'PGI Income Survey - Occupied Rate',
	`tot_inc` varchar(12) NOT NULL COMMENT 'Income - Total Income'
	); 


	 CREATE TABLE building_res (
	`acct` varchar(25) NOT NULL COMMENT 'Account Number',
	`property_use_cd` varchar(16) COMMENT 'Property Use Code See Code Descriptions(Real) - State Class: Code Or desc_r_01_state_class.txt',
	`bld_num` varchar(10) NOT NULL COMMENT 'Building Number',
	`impr_tp` char(4) COMMENT 'Building Type See Code Descriptions(Real) - Building Type Code Or desc_r_02_building_type_code.txt',
	`impr_mdl_cd` char(4) COMMENT 'Building Style See Code Descriptions(Real) - Building Style Or desc_r_03_building_style.txt',
	`structure` char(3) COMMENT 'Building Class See Code Descriptions(Real) - Building Class Or desc_r_04_building_class.txt',
	`structure_dscr` varchar(50) COMMENT 'Class of improvement - Description',
	`dpr_val` varchar(12) COMMENT 'Depreciated Value',
	`cama_replacement_cost` varchar(12) COMMENT 'Replacement Cost',
	`accrued_depr_pct` varchar(9) COMMENT 'Accrued Replacement Cost',
	`qa_cd` char(2) COMMENT 'Quality Code See Code Descriptions(Real) - Quality Code Or desc_r_07_quality_code.txt',
	`dscr` varchar(50) COMMENT 'Building Quality Codes - Description',
	`date_erected` varchar(4) COMMENT 'Actual Year Built',
	`eff` varchar(4) COMMENT 'Effective Year Built',
	`yr_remodel` varchar(4) NOT NULL COMMENT 'Year Remodeled',
	`yr_roll` char(4) NOT NULL COMMENT 'Year On Roll',
	`appr_by` char(5) NOT NULL COMMENT 'Building Appraisal By',
	`appr_dt` varchar(10) COMMENT 'Date Appraised Format MM/DD/YYYY',
	`notes` varchar(150) COMMENT 'Note',
	`im_sq_ft` varchar(10) NOT NULL COMMENT 'Base Area',
	`act_ar` varchar(10) NOT NULL COMMENT 'Actual Area',
	`heat_ar` varchar(10) NOT NULL COMMENT 'Heated Area',
	`gross_ar` varchar(10) NOT NULL COMMENT 'Gross Area',
	`eff_ar` varchar(10) NOT NULL COMMENT 'Effective Area',
	`base_ar` varchar(10) NOT NULL COMMENT 'Base Area',
	`perimeter` varchar(10) NOT NULL COMMENT 'Perimeter',
	`pct` varchar(5) NOT NULL COMMENT 'Percent Complete',
	`bld_adj` varchar(7) NOT NULL COMMENT 'Building Adjustment',
	`rcnld` varchar(14) COMMENT 'Building Replace Cost New',
	`size_index` varchar(10) NOT NULL COMMENT 'Building Price Adjustment',
	`lump_sum_adj` varchar(12) NOT NULL COMMENT 'Building Total Unit Adjustment'
	); 


	 CREATE TABLE land (
	`acct` varchar(13) NOT NULL COMMENT 'Account Number',
	`num` varchar(10) NOT NULL COMMENT 'Common or Unclassified Land - Line Number',
	`use_cd` char(4) COMMENT 'Common or Unclassified Land - Use Code See Code Descriptions(Real) - Land UseCode Or desc_r_15_land_usecode.txt',
	`use_dscr` varchar(50) COMMENT 'Land Use Codes - Description',
	`inf_cd` varchar(4) COMMENT 'Common or Unclassified Land - Influence Code See Code Descriptions(Real) - Influence Factors Or desc_r_16_influence_factors.txt',
	`inf_dscr` varchar(50) COMMENT 'Land Influence Factors - Description',
	`inf_adj` varchar(7) COMMENT 'Land Influence Factors - Percent Adjustment',
	`tp` char(2) COMMENT 'Common or Unclassified Land - Unit Type',
	`uts` varchar(14) COMMENT 'Common or Unclassified Land - Units',
	`sz_fact` varchar(7) COMMENT 'Common or Unclassified Land - Size Factor',
	`inf_fact` varchar(7) COMMENT 'Common or Unclassified Land - Influence Factor',
	`cond` varchar(7) COMMENT 'Common or Unclassified Land - Percent Condition',
	`ovr_dscr` varchar(50) COMMENT 'Land Override Codes - Description',
	`tot_adj` varchar(13) COMMENT 'Common or Unclassified Land - Total Adjustments',
	`unit_prc` varchar(13) COMMENT 'Common or Unclassified Land - Unit Price',
	`adj_unit_prc` varchar(15) COMMENT 'Common or Unclassified Land - Adjusted Unit Price',
	`val` varchar(12) COMMENT 'Common or Unclassified Land - Land Value',
	`ovr_val` varchar(12) COMMENT 'Common or Unclassified Land - Override Value'
	); 

# importin our data into the created tables

https://dev.mysql.com/doc/refman/5.7/en/mysqlimport.html

The below commands are for the tables created above, only, for the purposes of showing you the import patterns.

Note: we're skipping an important flag in the below example, and in the data we're looking at in the server today. Specifically, we are not skipping the header row. I kept it in there as a basic validation for myself that my columns were lined up right. But we would want to use the --ignore-lines flag in mysqlimport in a more automated pipeline.

  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 building_other.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 building_res.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 land.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 real_neighborhood_code.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 real_acct.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 permits.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 parcel_tieback.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 owners.txt -u root -p
  	mysqlimport --local --lines-terminated-by="\n" --fields-terminated-by="\t" HCAD_REAL_2022 deeds.txt -u root -p